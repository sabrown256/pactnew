/*
 * TPDCA.C - test C99 Variable Length Array functionality
 *
 * Source Version: 9.0
 * Software Release #: LLNL-CODE-422942
 *
 */

#include "cpyright.h"

#include "pdb.h"

/*--------------------------------------------------------------------------*/
/*--------------------------------------------------------------------------*/

int seta(int n, int m, double f[n][m])
   {int in, im, rv;

    rv = 0;

    for (in = 0; in < n; in++)
        {for (im = 0; im < m; im++)
	     f[in][im] = 1000.0*in + im;};

    return(rv);}

/*--------------------------------------------------------------------------*/
/*--------------------------------------------------------------------------*/

int chga(int n, int m, double *f)
   {int i, l, rv;

    rv = 0;
    l  = n*m;

    for (i = 0; i < l; i++)
        f[i] *= -1.0;

    return(rv);}

/*--------------------------------------------------------------------------*/
/*--------------------------------------------------------------------------*/

int usea(int n, int m, double f[n][m])
   {int in, im, rv;

    rv = 0;

    for (in = 0; in < n; in++)
        {for (im = 0; im < m; im++)
	     printf(" %7g", f[in][im]);
	 printf("\n");};

    return(rv);}

/*--------------------------------------------------------------------------*/
/*--------------------------------------------------------------------------*/

/* VLA - variable length array example */

int vla(int n, int m)
   {int rv;
    double f[n][m];

    rv = seta(n, m, f);
    rv = chga(n, m, (double *) f);
    rv = usea(n, m, f);

    return(rv);}

/*--------------------------------------------------------------------------*/
/*--------------------------------------------------------------------------*/

/* DYA - dynamic array example */

int dya(int n, int m)
   {int l, rv;
    double *f;

    l = n*m;
    f = malloc(l*sizeof(double));

    rv = 0;
    rv = seta(n, m, (double (*)[m]) f);
    rv = chga(n, m, f);
    rv = usea(n, m, (double (*)[m]) f);

    return(rv);}

/*--------------------------------------------------------------------------*/
/*--------------------------------------------------------------------------*/

int main(int c, char **v)
   {int rv;

    rv = vla(20, 8);
    rv = dya(10, 10);

    return(rv);}

/*--------------------------------------------------------------------------*/
/*--------------------------------------------------------------------------*/

