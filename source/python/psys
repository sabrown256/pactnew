#!/bin/csh -f
#
# PSYS - Python build script
#
# include "cpyright.h"
#

unalias *

@ err = 0

source ../scripts/functions-pact.csh

@ n = $#argv
set tgt = $argv[$n]
@ n = $n - 1
set arg = ( $argv[1-$n] )
unset n

while ($#argv > 0)
   switch ($1)
      case -h:
           echo ""
           echo "Usage: psys [-h] [<arg>*] <tgt>"
           echo "   h     this help message"
           echo "   <arg> argument to pact executable"
           echo "   <tgt> make target"
           echo ""
           exit(1)
      default:
           breaksw
   endsw
   shift
end

InitLog log $cwd/z-${System}/log.psys

set vlst = ""
if (($PY_Vers =~ 2*) && ($HAVE_PY_NUMERIC == TRUE)) then
   flog $log set vlst = ( $vlst 2.numeric )
endif
if (($PY_Vers =~ 2*) && ($HAVE_PY_NUMPY == TRUE)) then
   flog $log set vlst = ( $vlst 2.numpy )
endif
if (($PY_Vers =~ 3*) && ($HAVE_PY_NUMPY == TRUE)) then
   flog $log set vlst = ( $vlst 3.numpy )
endif

#--------------------------------------------------------------------------
#--------------------------------------------------------------------------

foreach v ( $vlst)

   flog $log pushd $v

   ftee $log pact $arg $tgt

   flog $log popd

end

#--------------------------------------------------------------------------
#--------------------------------------------------------------------------

exit($err)
